



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
        <link rel="canonical" href="https://pages.charlesreid1.com/russian-rainbow-mind-machine/keymaker/">
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../">
      <meta name="generator" content="mkdocs-0.17.3, mkdocs-material-2.7.2">
    
    
      
        <title>Keymaker - Ру́сский Радуга ум машина</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.8d40d89b.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/application-palette.6079476c.css">
      
    
    
      <script src="../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:300,400,400i,700|Ubuntu+Mono">
        <style>body,input{font-family:"Ubuntu","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Ubuntu Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
      <link rel="stylesheet" href="../css/custom.css">
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="red" data-md-color-accent="red">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <a href="#-" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://pages.charlesreid1.com/russian-rainbow-mind-machine" title="Ру́сский Радуга ум машина" class="md-header-nav__button md-logo">
          
            <i class="md-icon">settings_input_component</i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                Ру́сский Радуга ум машина
              </span>
              <span class="md-header-nav__topic">
                Keymaker
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://git.charlesreid1.com/bots/russian-rainbow-mind-machine" title="Go to repository" class="md-source" data-md-source="">
    
    <div class="md-source__repository">
      Ру́сский-Радуга-ум-машина
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <span class="md-nav__button md-logo">
      
        <i class="md-icon">settings_input_component</i>
      
    </span>
    Ру́сский Радуга ум машина
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://git.charlesreid1.com/bots/russian-rainbow-mind-machine" title="Go to repository" class="md-source" data-md-source="">
    
    <div class="md-source__repository">
      Ру́сский-Радуга-ум-машина
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../installing/" title="Installing" class="md-nav__link">
      Installing
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../quickstart/" title="Quick Start" class="md-nav__link">
      Quick Start
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" checked>
    
    <label class="md-nav__link" for="nav-4">
      Components
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Components
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
    <a href="./" title="Keymaker" class="md-nav__link md-nav__link--active">
      Keymaker
    </a>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../shepherd/" title="Shepherd" class="md-nav__link">
      Shepherd
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../sheep/" title="Sheep" class="md-nav__link">
      Sheep
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../docker/" title="Docker" class="md-nav__link">
      Docker
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../dev-workflow/" title="Developers Workflow" class="md-nav__link">
      Developers Workflow
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../credits/" title="Credits" class="md-nav__link">
      Credits
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="-">Ключ-манипулятор<a class="headerlink" href="#-" title="Permanent link">&para;</a></h1>
<p>клавишник</p>
<p>Вы определенно можете доверять этому ключевому клиенту. кредит</p>
<p>Keymaker - это объект, который используется для аутентификации с помощью
Twitter и генерирования ключей OAuth, которые приложение должно делать
от имени пользователя.</p>
<h1 id="oauth-">Трехсторонний OAuth-процесс<a class="headerlink" href="#oauth-" title="Permanent link">&para;</a></h1>
<p>Keymaker выполняет одноразовый шаг авторизации, который необходимо
выполнить один раз для каждой учетной записи Sheep = Twitter bot =
Twitter.</p>
<p>Keymaker получит набор «предметов» (подробнее об этом в один момент), с
одним элементом = один Овечка = один бот = одна учетная запись Twitter
и т. Д. Keymaker выполняет итерацию через каждый элемент и выполняет
трехногий процесс OAuth ,</p>
<p>Вот краткое описание процесса:</p>
<ul>
<li>The three legs are: the user (the bot account), the
    credential-checker (Twitter), and the consumer (your
    rainbowmindmachine app - specifically, the Keymaker)</li>
<li>The Keymaker will initiate the process by requesting an OAuth URL
    from Twitter (this is how a Twitter app asks a user for permission
    to access their account)</li>
<li>Twitter will return an OAuth URL to the Keymaker, which will pass it
    to the user</li>
<li>The user will open the URL in their browser, and sign in using a bot
    account</li>
<li>Twitter will verify the credentials of the user, and create a
    temporary PIN number that is shown to the user</li>
<li>The user will copy and paste that PIN number into the Keymaker,
    which passes the PIN to Twitter</li>
<li>Twitter verifies the PIN matches the one given to the user, and
    grants the application the access it requested.</li>
</ul>
<p>Почему песня и танец? Трехсторонний процесс аутентификации предназначен
для того, чтобы приложения могли проверять личность пользователя (т. Е.
Да, этот пользователь фактически предоставил разрешение для приложения
контролировать свою учетную запись) без необходимости обработки
конфиденциальных данных, таких как хэшированный пароль
пользователя. Это также помогает Twitterу контролировать
процесс.</p>
<h1 id="_1">пример<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h1>
<p>Давайте посмотрим на пример. Чтобы создать Apollo Space Junk Bot Flock,
мы использовали бы три элемента, соответствующие трем ботам APOLLO
Space Junk (@ apollo11junk, @ apollo12junk, @ apollo13junk). Поскольку
это боты генерации диалога Queneau, три элемента - три файла JSON,
заполненные данными, которые используются ботами для создания
диалога.</p>
<h1 id="keymaker">Подклассы Keymaker<a class="headerlink" href="#keymaker" title="Permanent link">&para;</a></h1>
<p>машина радужного разума предназначена для расширения, поэтому важно, как
мы создаем производные классы из класса Keymaker.</p>
<p>У нас есть два примера: FileKeymaker и TxtKeymaker. Эти два Keymakers
позволяют Keymaker использовать файлы определенного типа (например,
текстовые файлы или файлы изображений) в качестве «элементов», которые
использует Keymaker для создания ботов Sheep.</p>
<h1 id="keymaker_1">Учетные записи Keymaker<a class="headerlink" href="#keymaker_1" title="Permanent link">&para;</a></h1>
<h1 id="api">Ввод ключа: ключи API<a class="headerlink" href="#api" title="Permanent link">&para;</a></h1>
<p>Keymaker требует ввода двух частей информации:</p>
<ul>
<li>Consumer token API key</li>
<li>Consumer token secret API key</li>
</ul>
<p>Эти жетоны используются для аутентификации (вашего приложения) с помощью
Twitter и позволяют им подтвердить, что вы являетесь владельцем своего
приложения Twitter. Они не связаны с бот-аккаунтом. Ключи
API-интерфейса потребительского токена и пользовательского
токена должны быть доступны из настроек главной учетной записи
бота.</p>
<p>(Вы создали основную учетную запись бота, не так ли?!?)</p>
<p>Существует три способа передачи ключей API в Keymaker: через JSON-файл,
через словарь или через переменные среды.</p>
<h1 id="json">Использование файла JSON<a class="headerlink" href="#json" title="Permanent link">&para;</a></h1>
<p>Чтобы указать ключи API в файле JSON:</p>
<p>apikeys.json:</p>
<div class="codehilite"><pre><span></span>{
    &quot;consumer_token&quot; : &quot;AAAAAAA&quot;,
    &quot;consumer_secret_token&quot; : &quot;BBBBBBBB&quot;
}
</pre></div>


<p>Затем создайте Keymaker и настройте ключи API следующим образом:</p>
<p>make_shepherd_with_json.py:</p>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="nn">rainbowmindmachine</span> <span class="kn">as</span> <span class="nn">rmm</span>

<span class="n">keymaker</span> <span class="o">=</span> <span class="n">rmm</span><span class="o">.</span><span class="n">Keymaker</span><span class="p">()</span>
<span class="n">keymaker</span><span class="o">.</span><span class="n">set_apikeys_file</span><span class="p">(</span><span class="s1">&#39;apikeys.json&#39;</span><span class="p">)</span>
</pre></div>


<h1 id="python">Использование словаря Python<a class="headerlink" href="#python" title="Permanent link">&para;</a></h1>
<p>Чтобы указать ключи API, используя словарь python</p>
<p>make_shepherd_with_dict.py:</p>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="nn">rainbowmindmachine</span> <span class="kn">as</span> <span class="nn">rmm</span>

<span class="n">keymaker</span> <span class="o">=</span> <span class="n">rmm</span><span class="o">.</span><span class="n">Keymaker</span><span class="p">()</span>
<span class="n">keymaker</span><span class="o">.</span><span class="n">set_apikeys_dict</span><span class="p">({</span>
    <span class="s2">&quot;consumer_token&quot;</span> <span class="p">:</span> <span class="s2">&quot;AAAAAAAAAAAA&quot;</span><span class="p">,</span>
    <span class="s2">&quot;consumer_token_secret&quot;</span> <span class="p">:</span> <span class="s2">&quot;BBBBBBBBBBBBB&quot;</span>
<span class="p">})</span>
</pre></div>


<h1 id="_2">Использование переменных среды<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h1>
<p>Этот последний метод полезен, если вы хотите настроить интеграционные
тесты и использовать фактические ключи API, но вы не хотите их жестко
закодировать в файле или подвергать их риску утечки. Большинство
тестовых служб, таких как Travis, предоставляют механизмы для
получения учетных данных и секретов в тестовых контейнерах.</p>
<p>Чтобы использовать этот метод, установите две переменные среды:</p>
<div class="codehilite"><pre><span></span>$ export CONSUMER_TOKEN=&quot;AAAAAAAA&quot;
$ export CONSUMER_TOKEN_SECRET=&quot;BBBBBBBBBBB&quot;
</pre></div>


<p>Теперь сделайте Keymaker следующим образом:</p>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="nn">rainbowmindmachine</span> <span class="kn">as</span> <span class="nn">rmm</span>

<span class="n">keymaker</span> <span class="o">=</span> <span class="n">rmm</span><span class="o">.</span><span class="n">Keymaker</span><span class="p">()</span>
<span class="n">keymaker</span><span class="o">.</span><span class="n">set_apikeys_env</span><span class="p">()</span>
</pre></div>


<h1 id="keymaker-oauth">Выход Keymaker: клавиши OAuth<a class="headerlink" href="#keymaker-oauth" title="Permanent link">&para;</a></h1>
<p>После того, как Keymaker и пользователь пройдут трехсторонний процесс
аутентификации, Twitter предоставит приложению пару токенов OAuth
(токен и секретный токен), которые приложение может использовать для
управления учетной записью пользователя на указанном уровне разрешений
(это будет длиться бесконечно или пока пользователь не аннулирует доступ
в своих настройках Twitter).</p>
<p>Новые токены OAuth можно легко переделать с использованием тех же
трехступенчатых процессов аутентификации, если ключи OAuth
потеряны или пользователь отозвал доступ и должен повторно
предоставить его.</p>
<p>Keymaker выводит эти токены OAuth вместе с другой информацией, которая
будет полезна для объекта Sheep, в словарь Python и выводит ее в файл
JSON, который будет передан Овцам, как только Пастух создаст каждого
Овца.</p>
<p>Файлы JSON - это «бот-ключи», в смысле «ключи к машине» или «ключи к
королевству». Они хранятся в каталоге ключей бота, который можно
настроить (см. Ниже).</p>
<h1 id="_3">Процесс создания ключа: сделайте ключ<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h1>
<p>После того, как ваш ключ настроен с помощью ключей API, вы можете
сделать токены OAuth (клавиши бота) с помощью метода
Keymaker.make_a_key ().</p>
<p>(Производные классы Keymaker обычно переопределяют или заменяют этот
метод, например, с помощью метода make_keys ().)</p>
<p>Если мы хотим проверить Keymaker и создать ключи для одного бота, мы
можем указать имя бота и имя файла JSON, чтобы сбрасывать его (и
управлять именем каталога ключей ботов):</p>
<div class="codehilite"><pre><span></span>import rainbowmindmachine as rmm

keymaker = rmm.Keymaker()
keymaker.make_a_key( name = &#39;My Bot&#39;,
                     json = &#39;mybot.json&#39;,
                     keys_out_dir = &#39;bot_keys&#39;)
</pre></div>


<h1 id="_4">связи<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h1>
<p><a href="../credits/">кредит</a></p>
<p><a href="https://pages.charlesreid1.com/b-apollo">Apollo Space Junk Bot Flock</a></p>
<p><a href="https://twitter.com/apollo11junk">@ apollo11junk</a></p>
<p><a href="https://twitter.com/apollo12junk">@ apollo12junk</a></p>
<p><a href="https://twitter.com/apollo13junk">@ apollo13junk</a></p>
<p><a href="../installing/">мастер бота</a></p>
<p><a href="../shepherd/">Пасти</a></p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../quickstart/" title="Quick Start" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Quick Start
              </span>
            </div>
          </a>
        
        
          <a href="../shepherd/" title="Shepherd" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Shepherd
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2018 <a href="https://charlesreid1.com">Charles Reid</a>, released under the <a href="https://opensource.org/licenses/MIT">MIT License</a>.<br />Photo Credit: <a href="https://www.flickr.com/photos/russloar/">Russ Loar</a> under the <a href="https://creativecommons.org/licenses/by-nc-nd/2.0/">CC BY-NC-ND License</a>
          </div>
        
        powered by
        <a href="http://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.0cf9b500.js"></script>
      
      <script>app.initialize({version:"0.17.3",url:{base:".."}})</script>
      
        <script src="../search/require.js"></script>
      
        <script src="../search/search.js"></script>
      
    
    
      
    
  </body>
</html>